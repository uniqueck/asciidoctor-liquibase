// *** WARNING: DO NOT MODIFY *** This is a generated Java source code! 
// 
// Generated by LF-ET 2.2.1 (230505a), https://www.lohrfink.de/lfet
// From decision table
// "/opt/data/github/asciidoctor/asciidoctor-liquibase/lfet/liquibase-xml-parser.lfet"
// 13.05.2023 23:16
// 
// Changes to this code resulting from refactorings can be synchronised
// with LF-ET using the function "Scrapbook Import".
// 
// Prolog Decision Table ---->
const Parser = require('xml2js').Parser;

function parseLiquibaseChangeSet(processModel, elements, logger, vfs, tillTag) {
        
    const content = []

    for (let elementIndex = 0; elementIndex < elements.length; elementIndex++) {
        let element = elements[elementIndex]
        console.log(element)
    // Prolog Decision Table <----
    
    // Condition C01: Element = createTable
    if (
    element['#name'] === 'createTable'
    )
    {
        // Rule R01 ---->
        
        // Trace ---->
        logger.info('liquibase-xml-parser - 20230513.231614 - 1 / 20')
        // Trace <----
        
        // Action A01: extract Table
        // 
        let tableName = element.$['tableName']
        processModel.tables.set(tableName, {})
        
        // Rule R01 <----
    }
    else
    {
        
        // Condition C02: Element = include
        if (
        element['#name'] === 'include'
        )
        {
            // Rule R02 ---->
            
            // Trace ---->
            logger.info('liquibase-xml-parser - 20230513.231614 - 2 / 20')
            // Trace <----
            
            // Action A02: follow include
            console.log(element.$['file'])
            //
            
            // Rule R02 <----
        }
        else
        {
            
            // Condition C03: Element = changeSet
            if (
            element['#name'] === 'changeSet'
            )
            {
                // Rule R03 ---->
                
                // Trace ---->
                logger.info('liquibase-xml-parser - 20230513.231614 - 3 / 20')
                // Trace <----
                
                // Action A03: parse changeSet
                parseLiquibaseChangeSet(processModel, element.$$, logger, vfs, tillTag)
                
                // Rule R03 <----
            }
            else
            {
                
                // Condition C04: Element = addPrimaryKey
                if (
                element['#name'] === 'addPrimaryKey'
                )
                {
                    // Rule R04 ---->
                    
                    // Trace ---->
                    logger.info('liquibase-xml-parser - 20230513.231614 - 4 / 20')
                    // Trace <----
                    
                    // Action A04: set primary key for column
                    //
                    
                    // Rule R04 <----
                }
                else
                {
                    
                    // Condition C05: Element = dropTable
                    if (
                    element['#name'] === 'dropTable'
                    )
                    {
                        // Rule R05 ---->
                        
                        // Trace ---->
                        logger.info('liquibase-xml-parser - 20230513.231614 - 5 / 20')
                        // Trace <----
                        
                        // Action A05: drop Table
                        //
                        
                        // Rule R05 <----
                    }
                    else
                    {
                        
                        // Condition C06: Element = preConditions
                        if (
                        element['#name'] === 'preConditions'
                        )
                        {
                            // Rule R06 ---->
                            
                            // Trace ---->
                            logger.info('liquibase-xml-parser - 20230513.231614 - 6 / 20')
                            // Trace <----
                            
                            // Action A11: ignore element
                            //
                            
                            // Rule R06 <----
                        }
                        else
                        {
                            
                            // Condition C07: Element = sql
                            if (
                            element['#name'] === 'sql'
                            )
                            {
                                // Rule R07 ---->
                                
                                // Trace ---->
                                logger.info('liquibase-xml-parser - 20230513.231614 - 7 / 20')
                                // Trace <----
                                
                                // Action A11: ignore element
                                //
                                
                                // Rule R07 <----
                            }
                            else
                            {
                                
                                // Condition C08: Element = createSequence
                                if (
                                element['#name'] === 'createSequence'
                                )
                                {
                                    // Rule R08 ---->
                                    
                                    // Trace ---->
                                    logger.info('liquibase-xml-parser - 20230513.231614 - 8 / 20')
                                    // Trace <----
                                    
                                    // Action A11: ignore element
                                    //
                                    
                                    // Rule R08 <----
                                }
                                else
                                {
                                    
                                    // Condition C09: Element = createProcedure
                                    if (
                                    element['#name'] === 'createProcedure'
                                    )
                                    {
                                        // Rule R09 ---->
                                        
                                        // Trace ---->
                                        logger.info('liquibase-xml-parser - 20230513.231614 - 9 / 20')
                                        // Trace <----
                                        
                                        // Action A11: ignore element
                                        //
                                        
                                        // Rule R09 <----
                                    }
                                    else
                                    {
                                        
                                        // Condition C10: Element = renameColumn
                                        if (
                                        element['#name'] === 'renameColumn'
                                        )
                                        {
                                            // Rule R10 ---->
                                            
                                            // Trace ---->
                                            logger.info('liquibase-xml-parser - 20230513.231614 - 10 / 20')
                                            // Trace <----
                                            
                                            // Action A06: rename Column
                                            //
                                            
                                            // Rule R10 <----
                                        }
                                        else
                                        {
                                            
                                            // Condition C11: Element = comment
                                            if (
                                            element['#name'] === 'comment'
                                            )
                                            {
                                                // Rule R11 ---->
                                                
                                                // Trace ---->
                                                logger.info('liquibase-xml-parser - 20230513.231614 - 11 / 20')
                                                // Trace <----
                                                
                                                // Action A11: ignore element
                                                //
                                                
                                                // Rule R11 <----
                                            }
                                            else
                                            {
                                                
                                                // Condition C12: Element = addColumn
                                                if (
                                                element['#name'] === 'addColumn'
                                                )
                                                {
                                                    // Rule R12 ---->
                                                    
                                                    // Trace ---->
                                                    logger.info('liquibase-xml-parser - 20230513.231614 - 12 / 20')
                                                    // Trace <----
                                                    
                                                    // Action A07: add Column
                                                    //
                                                    
                                                    // Rule R12 <----
                                                }
                                                else
                                                {
                                                    
                                                    // Condition C13: Element = dropColumn
                                                    if (
                                                    element['#name'] === 'dropColumn'
                                                    )
                                                    {
                                                        // Rule R13 ---->
                                                        
                                                        // Trace ---->
                                                        logger.info('liquibase-xml-parser - 20230513.231614 - 13 / 20')
                                                        // Trace <----
                                                        
                                                        // Action A08: drop Column
                                                        //
                                                        
                                                        // Rule R13 <----
                                                    }
                                                    else
                                                    {
                                                        
                                                        // Condition C14: Element = rollback
                                                        if (
                                                        element['#name'] === 'rollback'
                                                        )
                                                        {
                                                            // Rule R14 ---->
                                                            
                                                            // Trace ---->
                                                            logger.info('liquibase-xml-parser - 20230513.231614 - 14 / 20')
                                                            // Trace <----
                                                            
                                                            // Action A11: ignore element
                                                            //
                                                            
                                                            // Rule R14 <----
                                                        }
                                                        else
                                                        {
                                                            
                                                            // Condition C15: Element = dropSequence
                                                            if (
                                                            element['#name'] === 'dropSequence'
                                                            )
                                                            {
                                                                // Rule R15 ---->
                                                                
                                                                // Trace ---->
                                                                logger.info('liquibase-xml-parser - 20230513.231614 - 15 / 20')
                                                                // Trace <----
                                                                
                                                                // Action A11: ignore element
                                                                //
                                                                
                                                                // Rule R15 <----
                                                            }
                                                            else
                                                            {
                                                                
                                                                // Condition C16: Element = addUniqueConstraint
                                                                if (
                                                                element['#name'] === 'addUniqueConstraint'
                                                                )
                                                                {
                                                                    // Rule R16 ---->
                                                                    
                                                                    // Trace ---->
                                                                    logger.info('liquibase-xml-parser - 20230513.231614 - 16 / 20')
                                                                    // Trace <----
                                                                    
                                                                    // Action A11: ignore element
                                                                    //
                                                                    
                                                                    // Rule R16 <----
                                                                }
                                                                else
                                                                {
                                                                    
                                                                    // Condition C17: Element = addForeignKeyConstraint
                                                                    if (
                                                                    element['#name'] === 'addForeignKeyConstraint'
                                                                    )
                                                                    {
                                                                        // Rule R17 ---->
                                                                        
                                                                        // Trace ---->
                                                                        logger.info('liquibase-xml-parser - 20230513.231614 - 17 / 20')
                                                                        // Trace <----
                                                                        
                                                                        // Action A09: addForeignKeyConstraint
                                                                        //
                                                                        
                                                                        // Rule R17 <----
                                                                    }
                                                                    else
                                                                    {
                                                                        
                                                                        // Condition C18: Element = tagDatabase
                                                                        if (
                                                                        element['#name'] === 'tagDatabase'
                                                                        )
                                                                        {
                                                                            
                                                                            // Condition C19: tag = tillTag
                                                                            if (
                                                                            tillTag === changeSetElement["@tag"]
                                                                            )
                                                                            {
                                                                                // Rule R18 ---->
                                                                                
                                                                                // Trace ---->
                                                                                logger.info('liquibase-xml-parser - 20230513.231614 - 18 / 20')
                                                                                // Trace <----
                                                                                
                                                                                // Action A13: finish parsing
                                                                                //
                                                                                
                                                                                // Rule R18 <----
                                                                            }
                                                                            else
                                                                            {
                                                                                // Rule R19 ---->
                                                                                
                                                                                // Trace ---->
                                                                                logger.info('liquibase-xml-parser - 20230513.231614 - 19 / 20')
                                                                                // Trace <----
                                                                                
                                                                                // Action A12: skip tag
                                                                                logger.warn(`skip tag '${element['#name']}'`);
                                                                                
                                                                                // Rule R19 <----
                                                                            }
                                                                        }
                                                                        else
                                                                        {
                                                                            // Rule R20 ---->
                                                                            
                                                                            // Trace ---->
                                                                            logger.info('liquibase-xml-parser - 20230513.231614 - 20 / 20')
                                                                            // Trace <----
                                                                            
                                                                            // Action A10: log unsupported element
                                                                            logger.warn(`Unsupported liquibase element '${element['#name']}' detected`)
                                                                            
                                                                            // Rule R20 <----
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
    
    // Epilog Decision Table ---->
}
    return content
}

module.exports = {
  parseLiquibaseChangeSet: (processModel, elements, logger, vfs, tillTag) => {
    return parseLiquibaseChangeSet(processModel, elements, logger, vfs, tillTag)
  }
}
// Epilog Decision Table <----

// End of generated Java source code
// Generated by LF-ET 2.2.1 (230505a), https://www.lohrfink.de/lfet

